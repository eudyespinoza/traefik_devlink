http:
  middlewares:
    redirect-https:
      redirectScheme:
        scheme: https
        permanent: true

    default-sec-headers:
      headers:
        stsSeconds: 31536000
        stsIncludeSubdomains: true
        stsPreload: true
        frameDeny: true
        contentTypeNosniff: true
        referrerPolicy: no-referrer

    gzip-compress:
      compress: {}

    cors-headers:
      headers:
        accessControlAllowOriginList:
          - "https://latitudarg.com"
          - "https://www.latitudarg.com"
          - "https://secureapprove.com"
          - "https://www.secureapprove.com"
          - "https://api.secureapprove.com"
        accessControlAllowMethods:
          - "GET"
          - "POST"
          - "PUT"
          - "DELETE"
          - "OPTIONS"
        accessControlAllowHeaders:
          - "Content-Type"
          - "Authorization"
          - "X-Requested-With"
          - "Accept"
          - "Origin"
          - "Idempotency-Key"
          - "X-API-TOKEN"
          - "x-locale"
        accessControlAllowCredentials: true
        accessControlMaxAge: 86400

  routers:
    # Redirige todo HTTP a HTTPS
    http-catchall:
      rule: "HostRegexp(`{any:.+}`)"
      entryPoints: [ "web" ]
      middlewares: [ "redirect-https" ]
      service: noop

    # Dashboard de Traefik (opcional)
    traefik-dashboard:
      entryPoints: [ "websecure" ]
      rule: Host(`proxy.tu-dominio.com`)
      service: api@internal
      middlewares: [ "default-sec-headers" ]
      tls: {}

    # NOTA: Los routers de SecureApprove se crean autom√°ticamente
    # desde los labels del docker-compose.yml

  services:
    noop:
      loadBalancer:
        servers:
          - url: "http://127.0.0.1"

tls:
  options:
    default:
      minVersion: VersionTLS12

  certificates:
    - certFile: /certs/latitudarg/latitudarg.com.crt
      keyFile: /certs/latitudarg/latitudarg.com.key
    - certFile: /certs/secureapprove/secureapprove.com.crt
      keyFile: /certs/secureapprove/secureapprove.com.key